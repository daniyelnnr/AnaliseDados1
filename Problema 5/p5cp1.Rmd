---
title: "Prob 5, CP 1"
author: "Daniyel Rocha"
date: "15 de agosto de 2017"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(openintro, quietly = T)
library(tidyverse, quietly = T)
library(dplyr, quietly = T)
#theme_set(theme_bw())
library(modelr, quietly = T)
library(broom, quietly = T)
library(GGally, quietly = T)
```
# Introdução

Para esta análise os dados que serão utilizados são referentes a encontros rápidos, também chamados de **"speed dating"**. Nesse tipo de encontro, diversas pessoas irão se conhecer, sendo cada par é sugerido por um sistema que foi alimentado com informações de cada participante e julga que aquele encontro deve acontecer. Após cada encontro, os participantes envolvidos deveriam preencher fichas avaliando a outra pessoa, com base em diversos critérios. Com isso, o conjunto de dados formado será analisado e perguntas envolvendo cada uma das variáveis foram elaboradas e serão respondidas neste relatório.

```{r}
#selecionando os dados sem os NA's
speed_dating <- na.omit(read.csv("https://raw.githubusercontent.com/nazareno/ciencia-de-dados-1/master/5-regressao/speed-dating/speed-dating.csv"))
```
like, int_corr(shar), attr, attr3_s
#var dependente quanto foi engraçado e a independente quanto achou bonito
#compartilhar interesses e hobbies de uma mesma pessoa 
#o quanto a inteligencia e a ambição influenciam no like para pessoas maiores de 30 anos?
#quanto mais uma pessoa se acha divertida e atraente maior será a probabilidade de achar que p2 irá querer se encontrar
```{r}
dados_selecionados <- speed_dating %>%
  select(like, shar, attr, attr3_s)

median(speed_dating$order)

dados_selecionados %>%
  ggpairs(lower = list(continuous = wrap("points", alpha = 0.3)))
```

```{r}
model <- lm(like ~ shar, data = dados_selecionados)

data_augmented <- dados_selecionados %>% 
  add_predictions(model) %>% 
  add_residuals(model)

# Modelo x dados
data_augmented %>% 
  ggplot(aes(x = shar)) + 
  geom_line(aes(y = pred), colour = "blue") + 
  geom_point(aes(y = like))

# Resíduos x dados
data_augmented %>% 
  ggplot(aes(x = shar)) + 
  geom_point(aes(y = resid)) +
  geom_ref_line(h = 0, colour = "grey80")

tidy(model, conf.int = TRUE)
glance(model, conf.int = TRUE)
```

